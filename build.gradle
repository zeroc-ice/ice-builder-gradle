// **********************************************************************
//
// Copyright (c) 2014-2016 ZeroC, Inc. All rights reserved.
//
// **********************************************************************

buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath "com.gradle.publish:plugin-publish-plugin:0.9.1"
    }
}

apply plugin: "com.gradle.plugin-publish"

apply plugin: 'groovy'
apply plugin: 'maven'

sourceCompatibility = 1.7
targetCompatibility = 1.7

dependencies {
    compile gradleApi()
    compile localGroovy()
}

sourceSets {
    main {
        groovy {
            srcDir "src/main/groovy"
        }
        resources {
            srcDir "src/main/resources"
        }
    }
}

version  = "1.3.1"
group = "com.zeroc.gradle.ice-builder"

pluginBundle {
    website = 'https://github.com/zeroc-ice/ice-builder-gradle'
    vcsUrl = 'https://github.com/zeroc-ice/ice-builder-gradle.git'
    description = 'Plugin to automate the compilation of Slice files to Java'
    tags = ['zeroc', 'ice', 'slice']

    plugins {
        slicePlugin {
            id = 'com.zeroc.gradle.ice-builder.slice'
            displayName = 'Ice Builder for Gradle'
        }
    }
}

if(project.hasProperty('nexusUrl')) {
    uploadArchives {
        repositories {
            mavenDeployer {
                repository(url: "${nexusUrl}/content/repositories/releases") {
                    authentication(userName: nexusUsername, password: nexusPassword)
                }
            }
        }
    }
}

//
// Used to build the gradle wrapper to automatically download and install
// the version of gradle needed to build plugin.
//
task wrapper(type: Wrapper) {
    gradleVersion = "2.11"
}
